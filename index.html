<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <meta name="theme-color" content="#0b0f1a"/>
  <meta name="color-scheme" content="dark"/>

  <title>ViralVault Store ‚Äî Checkout PIX & Pedido</title>
  <meta name="description" content="ViralVault ‚Äî loja de itens/servi√ßos para Roblox com checkout PIX, verifica√ß√£o de pedido por Order ID e hist√≥rico de compras."/>
  <meta name="robots" content="index,follow,max-image-preview:large"/>
  <link rel="canonical" href="https://viralvault-store.vercel.app/"/>

  <!-- Open Graph / Social -->
  <meta property="og:type" content="website"/>
  <meta property="og:title" content="ViralVault Store"/>
  <meta property="og:description" content="Checkout PIX, verifica√ß√£o por Order ID e hist√≥rico de compras."/>
  <meta property="og:url" content="https://viralvault-store.vercel.app/"/>
  <meta property="og:site_name" content="ViralVault"/>

  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:title" content="ViralVault Store"/>
  <meta name="twitter:description" content="Checkout PIX, verifica√ß√£o por Order ID e hist√≥rico de compras."/>

  <!-- JSON-LD (WebSite) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "ViralVault Store",
    "url": "https://viralvault-store.vercel.app/",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://viralvault-store.vercel.app/?q={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>

  <!-- PWA: manifest + icons (data URIs) -->
  <link rel="manifest" href="data:application/manifest+json,%7B%22name%22%3A%22ViralVault%20Store%22%2C%22short_name%22%3A%22ViralVault%22%2C%22start_url%22%3A%22.%2F%22%2C%22display%22%3A%22standalone%22%2C%22background_color%22%3A%22%230b0f1a%22%2C%22theme_color%22%3A%22%230b0f1a%22%2C%22icons%22%3A%5B%7B%22src%22%3A%22data%3Aimage%2Fsvg%2Bxml%2C%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%201024%201024'%3E%3Cdefs%3E%3CradialGradient%20id%3D'g'%20cx%3D'30%25'%20cy%3D'20%25'%20r%3D'90%25'%3E%3Cstop%20offset%3D'0'%20stop-color%3D'%2390b7ff'%2F%3E%3Cstop%20offset%3D'1'%20stop-color%3D'%235f64ff'%2F%3E%3C%2FradialGradient%3E%3C%2Fdefs%3E%3Crect%20width%3D'1024'%20height%3D'1024'%20rx%3D'220'%20fill%3D'%230b0f1a'%2F%3E%3Ccircle%20cx%3D'512'%20cy%3D'512'%20r%3D'420'%20fill%3D'url(%23g)'%2F%3E%3Ctext%20x%3D'50%25'%20y%3D'56%25'%20text-anchor%3D'middle'%20font-family%3D'Inter%2C%20system-ui%2C%20Segoe%20UI'%20font-size%3D'320'%20font-weight%3D'800'%20fill%3D'%230b0f1a'%3EVV%3C%2Ftext%3E%3C%2Fsvg%3E%22%2C%22sizes%22%3A%221024x1024%22%2C%22type%22%3A%22image%2Fsvg%2Bxml%22%7D%5D%7D"/>

  <!-- Apple -->
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <meta name="apple-mobile-web-app-title" content="ViralVault"/>
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>

  <!-- Preconnect + minimal font strategy (system-first) -->
  <style>
    :root{
      --bg:#070a12;
      --panel:#0c1120cc;
      --panel2:#0b1020a6;
      --stroke:#ffffff14;
      --text:#eef2ff;
      --muted:#b7c0dd;
      --muted2:#8f98b6;
      --brand1:#7a7cff;
      --brand2:#47b3ff;
      --good:#23d18b;
      --warn:#ffcc66;
      --bad:#ff4d6d;
      --shadow: 0 20px 80px rgba(0,0,0,.55);
      --shadow2: 0 12px 40px rgba(0,0,0,.35);
      --r1: 28px;
      --r2: 22px;
      --r3: 16px;
      --ease: cubic-bezier(.2,.8,.2,1);
      --max: 1120px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color:var(--text);
      background: radial-gradient(1200px 800px at 15% 10%, rgba(122,124,255,.25), transparent 60%),
                  radial-gradient(900px 600px at 85% 18%, rgba(71,179,255,.22), transparent 55%),
                  radial-gradient(900px 700px at 50% 90%, rgba(35,209,139,.08), transparent 60%),
                  var(--bg);
      overflow-x:hidden;
    }

    /* subtle ‚Äúagency‚Äù texture */
    body:before{
      content:"";
      position:fixed; inset:0;
      pointer-events:none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='160'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='160' height='160' filter='url(%23n)' opacity='.25'/%3E%3C/svg%3E");
      opacity:.06;
      mix-blend-mode: overlay;
    }

    a{ color:inherit; text-decoration:none; }
    button{ font:inherit; }

    .wrap{ max-width:var(--max); margin:0 auto; padding: 18px 16px 120px; }

    /* Top bar */
    .top{
      position:sticky; top:0; z-index:50;
      backdrop-filter: blur(14px);
      background: linear-gradient(180deg, rgba(7,10,18,.85), rgba(7,10,18,.35));
      border-bottom: 1px solid rgba(255,255,255,.06);
    }
    .topInner{ max-width:var(--max); margin:0 auto; padding: 14px 16px; display:flex; align-items:center; gap:12px; }

    .brand{
      display:flex; align-items:center; gap:12px;
      min-width: 180px;
    }
    .logo{
      width:40px; height:40px; border-radius:14px;
      background: radial-gradient(circle at 30% 20%, #90b7ff, #5f64ff 65%, #2b2f8f);
      box-shadow: 0 12px 30px rgba(110,120,255,.28);
      display:grid; place-items:center;
      color:#0b0f1a;
      font-weight:900;
      letter-spacing:-.5px;
    }
    .brandTitle{ line-height:1.1; }
    .brandTitle b{ display:block; font-size:15px; }
    .brandTitle span{ font-size:12px; color:var(--muted2); }

    .spacer{ flex:1; }

    .pill{
      display:inline-flex; align-items:center; gap:10px;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      box-shadow: var(--shadow2);
      color: var(--text);
    }
    .pill select{
      background: transparent; border:0; outline:0; color: var(--text);
      font-weight:650;
      -webkit-appearance:none; appearance:none;
    }

    .btn{
      cursor:pointer;
      border:1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.04));
      color: var(--text);
      padding: 12px 14px;
      border-radius: 14px;
      display:inline-flex; align-items:center; gap:10px;
      transition: transform .12s var(--ease), filter .2s var(--ease), border-color .2s var(--ease);
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    .btn:active{ transform: translateY(1px) scale(.99); }
    .btnPrimary{
      border-color: rgba(122,124,255,.55);
      background: linear-gradient(135deg, rgba(122,124,255,.95), rgba(71,179,255,.85));
      color: #0b0f1a;
      font-weight:800;
    }
    .btnGhost{ background: rgba(255,255,255,.03); }

    /* Hero */
    .hero{
      padding: 22px 0 14px;
    }
    .heroGrid{
      display:grid; grid-template-columns: 1.2fr .8fr;
      gap: 18px;
      align-items: stretch;
    }

    @media (max-width: 860px){
      .heroGrid{ grid-template-columns: 1fr; }
      .brand{ min-width: unset; }
    }

    .card{
      border:1px solid rgba(255,255,255,.08);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border-radius: var(--r1);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .cardInner{ padding: 22px; }

    .kicker{
      display:inline-flex; align-items:center; gap:10px;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(11,16,32,.55);
      color: var(--muted);
      font-size: 13px;
    }
    .dot{ width:10px; height:10px; border-radius:50%; background: var(--good); box-shadow: 0 0 0 6px rgba(35,209,139,.14); }

    h1{
      margin: 14px 0 10px;
      font-size: clamp(34px, 4.2vw, 54px);
      line-height: 1.02;
      letter-spacing: -1.2px;
    }
    .sub{
      margin:0;
      color: var(--muted);
      font-size: 15px;
      line-height:1.55;
      max-width: 62ch;
    }

    .heroActions{ display:flex; flex-wrap:wrap; gap:12px; margin-top: 16px; }

    .mini{
      display:grid; gap:10px;
    }
    .stat{
      border-radius: var(--r2);
      border:1px solid rgba(255,255,255,.08);
      background: rgba(11,16,32,.55);
      padding: 14px 14px;
    }
    .statTop{ display:flex; justify-content:space-between; align-items:center; gap:12px; }
    .statTop b{ font-size: 13px; color: var(--muted); font-weight:700; }
    .badge{
      font-size: 12px; font-weight:750;
      padding: 6px 10px; border-radius: 999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      color: var(--text);
    }
    .statVal{ margin-top:10px; font-size: 14px; color: var(--muted2); }

    /* Sections */
    .section{ margin-top: 18px; }
    .sectionHead{ display:flex; align-items:flex-end; justify-content:space-between; gap:12px; margin-bottom: 10px; }
    .sectionHead h2{ margin:0; font-size: 22px; letter-spacing:-.4px; }
    .sectionHead p{ margin:0; color: var(--muted2); font-size: 13px; }

    .grid{ display:grid; grid-template-columns: 1fr 1fr; gap: 14px; }
    @media (max-width: 860px){ .grid{ grid-template-columns: 1fr; } }

    .panel{
      border:1px solid rgba(255,255,255,.08);
      background: linear-gradient(180deg, rgba(12,17,32,.82), rgba(12,17,32,.50));
      border-radius: var(--r1);
      box-shadow: var(--shadow2);
      overflow:hidden;
    }
    .panel .inner{ padding: 18px; }

    .row{ display:flex; gap:10px; flex-wrap:wrap; }

    label{ display:block; font-size: 12px; color: var(--muted2); margin: 10px 0 8px; }
    input, textarea{
      width:100%;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      color: var(--text);
      padding: 12px 12px;
      border-radius: 14px;
      outline:none;
    }
    input:focus, textarea:focus{ border-color: rgba(122,124,255,.55); box-shadow: 0 0 0 4px rgba(122,124,255,.12); }

    .help{ margin-top:8px; color: var(--muted2); font-size: 12px; }

    /* Catalog */
    .catGrid{ display:grid; grid-template-columns: 1fr; gap:10px; margin-top:10px; }
    .item{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      border-radius: 18px;
      padding: 14px;
      display:flex; justify-content:space-between; gap:12px; align-items:center;
    }
    .itemLeft{ min-width:0; }
    .itemLeft b{ display:block; font-size: 14px; letter-spacing:-.2px; }
    .itemLeft span{ display:block; font-size: 12px; color: var(--muted2); margin-top:4px; }
    .price{ font-weight:850; }
    .qty{
      display:inline-flex; align-items:center; gap:8px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      border-radius: 999px;
      padding: 6px 10px;
    }
    .qty button{
      width:30px; height:30px; border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      color: var(--text);
      cursor:pointer;
    }
    .qty i{ font-style:normal; min-width:18px; text-align:center; color: var(--muted); font-weight:800; }

    .divider{ height:1px; background: rgba(255,255,255,.08); margin: 12px 0; }

    /* Toast */
    .toast{
      position:fixed; left:50%; bottom: 92px; transform: translateX(-50%);
      padding: 12px 14px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(8,12,22,.92);
      box-shadow: var(--shadow2);
      color: var(--text);
      max-width: min(560px, calc(100vw - 24px));
      opacity:0;
      pointer-events:none;
      transition: opacity .2s var(--ease), transform .2s var(--ease);
    }
    .toast.show{ opacity:1; transform: translateX(-50%) translateY(-2px); }
    .toast small{ color: var(--muted2); display:block; margin-top:4px; }

    /* Bottom tab bar */
    .tabs{
      position:fixed; left:0; right:0; bottom:0;
      padding: 10px 12px calc(10px + env(safe-area-inset-bottom));
      background: linear-gradient(180deg, rgba(7,10,18,0), rgba(7,10,18,.92) 28%, rgba(7,10,18,.98));
      backdrop-filter: blur(16px);
      z-index:60;
      border-top: 1px solid rgba(255,255,255,.08);
    }
    .tabsInner{
      max-width:var(--max);
      margin:0 auto;
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
    }
    .tab{
      display:flex; align-items:center; justify-content:center; gap:10px;
      border-radius: 18px;
      padding: 12px 10px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      color: var(--muted);
      cursor:pointer;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    .tab.active{ color: var(--text); border-color: rgba(122,124,255,.42); background: rgba(122,124,255,.10); }
    .tab span{ font-weight:800; font-size: 13px; }

    /* Utility */
    .hidden{ display:none !important; }
    .mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce){
      *{ scroll-behavior:auto !important; transition:none !important; }
    }
  </style>
</head>
<body>
  <header class="top">
    <div class="topInner">
      <div class="brand" role="button" tabindex="0" data-scroll="#home">
        <div class="logo" aria-hidden="true">VV</div>
        <div class="brandTitle">
          <b>ViralVault Store</b>
          <span id="netStatus">Sistema online</span>
        </div>
      </div>

      <div class="spacer"></div>

      <div class="pill" title="Idioma">
        <span aria-hidden="true">üåê</span>
        <select id="langSel" aria-label="Idioma">
          <option value="pt">PT-BR</option>
          <option value="en">EN</option>
          <option value="es">ES</option>
        </select>
      </div>

      <button class="btn btnGhost" id="btnDiscord" type="button" title="Abrir Discord" aria-label="Abrir Discord">
        <span aria-hidden="true">üí¨</span>
        <span>Discord</span>
      </button>

      <button class="btn btnPrimary" id="btnInstall" type="button" title="Instalar app" aria-label="Instalar PWA">
        <span aria-hidden="true">‚¨áÔ∏è</span>
        <span>Instalar</span>
      </button>
    </div>
  </header>

  <main class="wrap" id="home">
    <section class="hero">
      <div class="heroGrid">
        <div class="card">
          <div class="cardInner">
            <div class="kicker"><span class="dot" aria-hidden="true"></span><span id="kickerText">Checkout PIX ‚Ä¢ Verifica√ß√£o por Order ID ‚Ä¢ Anti-golpe</span></div>
            <h1 id="heroTitle">Turbine seus itens do Roblox.</h1>
            <p class="sub" id="heroSub">Escolha no cat√°logo, finalize o checkout em etapas e acompanhe o pedido no app. Suporte exclusivo via Discord.</p>

            <div class="heroActions">
              <button class="btn btnPrimary" type="button" data-scroll="#catalog">
                <span aria-hidden="true">üõçÔ∏è</span><span id="ctaCatalog">Ver cat√°logo</span>
              </button>
              <button class="btn" type="button" data-scroll="#checkout">
                <span aria-hidden="true">üßæ</span><span id="ctaCheckout">Ir pro checkout</span>
              </button>
              <button class="btn" type="button" data-scroll="#order">
                <span aria-hidden="true">üîé</span><span id="ctaOrder">Ver pedido</span>
              </button>
            </div>
          </div>
        </div>

        <div class="mini">
          <div class="stat">
            <div class="statTop">
              <b id="s1">Status</b>
              <span class="badge" id="badgeOnline">OK</span>
            </div>
            <div class="statVal" id="s1v">Conectando ao sistema‚Ä¶</div>
          </div>
          <div class="stat">
            <div class="statTop">
              <b id="s2">Carrinho</b>
              <span class="badge" id="badgeCart">0 itens</span>
            </div>
            <div class="statVal" id="s2v">Seu carrinho est√° vazio.</div>
          </div>
          <div class="stat">
            <div class="statTop">
              <b id="s3">Suporte</b>
              <span class="badge">Discord</span>
            </div>
            <div class="statVal" id="s3v">Abra um ticket/DM no servidor.</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Catalog -->
    <section class="section" id="catalog">
      <div class="sectionHead">
        <div>
          <h2 id="catTitle">Cat√°logo</h2>
          <p id="catSub">Toque em + para adicionar ao carrinho.</p>
        </div>
        <div class="row">
          <button class="btn" id="btnReloadCatalog" type="button"><span aria-hidden="true">‚ü≥</span><span id="reloadTxt">Recarregar</span></button>
          <button class="btn" id="btnViewCart" type="button"><span aria-hidden="true">üß∫</span><span id="viewCartTxt">Ver carrinho</span></button>
        </div>
      </div>

      <div class="panel">
        <div class="inner">
          <div id="catalogState" class="help">Carregando cat√°logo‚Ä¶</div>
          <div class="catGrid" id="catalogList"></div>
        </div>
      </div>
    </section>

    <!-- Checkout -->
    <section class="section" id="checkout">
      <div class="sectionHead">
        <div>
          <h2 id="coTitle">Checkout</h2>
          <p id="coSub">Finalize em etapas ‚Äî simples e sem confus√£o.</p>
        </div>
        <div class="row">
          <span class="badge" id="stepBadge">1/3</span>
        </div>
      </div>

      <div class="grid">
        <div class="panel">
          <div class="inner">
            <div class="row" style="gap:10px; margin-bottom:10px;">
              <button class="btn" type="button" id="step1Btn"><b>1</b> <span id="st1">Dados</span></button>
              <button class="btn" type="button" id="step2Btn"><b>2</b> <span id="st2">Revis√£o</span></button>
              <button class="btn" type="button" id="step3Btn"><b>3</b> <span id="st3">PIX</span></button>
            </div>

            <div id="step1">
              <label id="lbUser">Seu user do Roblox (obrigat√≥rio)</label>
              <input id="rbxUser" autocomplete="username" inputmode="text" placeholder="Ex: SeuUser_123"/>
              <div class="help" id="userHelp">Dica: s√≥ letras, n√∫meros e _ (3‚Äì20 caracteres).</div>
              <div class="divider"></div>
              <button class="btn btnPrimary" id="btnNext" type="button"><span id="nextTxt">Pr√≥ximo</span> <span aria-hidden="true">‚Üí</span></button>
            </div>

            <div id="step2" class="hidden">
              <div class="help" id="reviewHelp">Revise seu carrinho e confirme.</div>
              <div id="reviewBox"></div>
              <div class="divider"></div>
              <div class="row">
                <button class="btn" id="btnBack" type="button">‚Üê <span id="backTxt">Voltar</span></button>
                <button class="btn btnPrimary" id="btnCreateOrder" type="button"><span aria-hidden="true">üßæ</span><span id="createTxt">Gerar pedido</span></button>
              </div>
            </div>

            <div id="step3" class="hidden">
              <div class="help" id="pixHelp">Copie o PIX e conclua o pagamento. Depois, acompanhe pelo Order ID.</div>
              <div class="divider"></div>
              <div class="row">
                <button class="btn" id="btnCopyPix" type="button"><span aria-hidden="true">üìã</span><span id="copyPixTxt">Copiar PIX</span></button>
                <button class="btn" id="btnGoOrder" type="button"><span aria-hidden="true">üîé</span><span id="goOrderTxt">Ir pra pedido</span></button>
              </div>
              <div class="divider"></div>
              <div class="help"><b id="orderIdLabel">Order ID:</b> <span class="mono" id="createdOrderId">‚Äî</span></div>
              <div class="help" id="pixBoxWrap"></div>
            </div>
          </div>
        </div>

        <div class="panel">
          <div class="inner">
            <h3 style="margin:0 0 6px; letter-spacing:-.3px;">Resumo</h3>
            <p style="margin:0; color:var(--muted2); font-size:13px;">Total, itens e lembretes de seguran√ßa.</p>
            <div class="divider"></div>
            <div class="help" id="sumCart">Carrinho vazio.</div>
            <div class="divider"></div>
            <div class="help" id="securityNote">Use apenas o app oficial ViralVault e confirme o Order ID antes de pagar.</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Order -->
    <section class="section" id="order">
      <div class="sectionHead">
        <div>
          <h2 id="ordTitle">Pedido</h2>
          <p id="ordSub">Verifique se √© oficial e veja o andamento.</p>
        </div>
        <div class="row">
          <button class="btn" id="btnMyBuys" type="button"><span aria-hidden="true">üßæ</span><span id="myBuysTxt">Minhas compras</span></button>
        </div>
      </div>

      <div class="panel">
        <div class="inner">
          <label id="lbOrderId">Cole o Order ID</label>
          <div class="row" style="gap:10px; align-items:stretch;">
            <input id="orderId" placeholder="Ex: VV-2026-..."/>
            <button class="btn btnPrimary" id="btnCheck" type="button"><span aria-hidden="true">üîé</span><span id="checkTxt">Verificar</span></button>
          </div>
          <div class="help" id="orderResult">Cole um Order ID e toque em Verificar.</div>
        </div>
      </div>
    </section>

    <!-- FAQ / Support -->
    <section class="section" id="faq">
      <div class="sectionHead">
        <div>
          <h2>FAQ</h2>
          <p>R√°pido e direto.</p>
        </div>
      </div>

      <div class="grid">
        <div class="panel">
          <div class="inner">
            <details>
              <summary style="cursor:pointer; font-weight:800;">Como sei que √© oficial?</summary>
              <p class="help">Use ‚ÄúPedido‚Äù e verifique o status do seu Order ID. Se n√£o aparecer, n√£o pague.</p>
            </details>
            <div class="divider"></div>
            <details>
              <summary style="cursor:pointer; font-weight:800;">Quanto tempo para entrega?</summary>
              <p class="help">Depende do produto. ‚ÄúPrioridade (24h)‚Äù entrega primeiro.</p>
            </details>
          </div>
        </div>
        <div class="panel">
          <div class="inner">
            <h3 style="margin:0 0 6px; letter-spacing:-.3px;">Suporte</h3>
            <p class="help" style="margin:0 0 10px;">Entre no Discord e abra um ticket/DM.</p>
            <div class="row">
              <button class="btn btnPrimary" id="btnDiscord2" type="button"><span aria-hidden="true">üí¨</span><span>Abrir Discord</span></button>
            </div>
            <div class="divider"></div>
            <div class="help" style="margin:0;">Rede oficial: <span class="mono">discord.gg/fWAWquBu</span></div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <div class="tabs" role="navigation" aria-label="Navega√ß√£o">
    <div class="tabsInner">
      <div class="tab active" data-scroll="#catalog"><span aria-hidden="true">üõçÔ∏è</span><span id="tabCat">Cat√°logo</span></div>
      <div class="tab" data-scroll="#checkout"><span aria-hidden="true">üßæ</span><span id="tabCo">Checkout</span></div>
      <div class="tab" data-scroll="#order"><span aria-hidden="true">üì¶</span><span id="tabOrd">Pedido</span></div>
      <div class="tab" data-scroll="#faq"><span aria-hidden="true">‚ùì</span><span id="tabFaq">FAQ</span></div>
    </div>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <script>
    // =========================
    // CONFIG
    // =========================
    const DISCORD_INVITE = "https://discord.gg/fWAWquBu";

    // IMPORTANT: esconder o Worker (n√£o mostrar na UI)
    // Ainda precisa da API para funcionar.
    // Se voc√™ trocar de Worker, altere SOMENTE aqui.
    const API_BASE = "https://viralvault-sign.darlanana06.workers.dev";

    // =========================
    // STATE
    // =========================
    const LS = {
      cart: "vv_cart_v3",
      profile: "vv_profile_v3",
      buysIndex: "vv_buys_v3" // fallback local
    };

    let deferredPrompt = null;
    let catalog = [];

    const $ = (s) => document.querySelector(s);
    const $$ = (s) => Array.from(document.querySelectorAll(s));

    function toast(msg, sub){
      const t = $("#toast");
      t.innerHTML = `${escapeHtml(msg)}${sub?`<small>${escapeHtml(sub)}</small>`:""}`;
      t.classList.add("show");
      clearTimeout(toast._tm);
      toast._tm = setTimeout(()=>t.classList.remove("show"), 2800);
    }

    function escapeHtml(str){
      return String(str)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    function moneyBRL(v){
      const n = Number(v||0);
      return n.toLocaleString("pt-BR", { style: "currency", currency: "BRL" });
    }

    function loadJSON(key, fallback){
      try{ const v = localStorage.getItem(key); return v ? JSON.parse(v) : fallback; }catch{ return fallback; }
    }
    function saveJSON(key, val){
      try{ localStorage.setItem(key, JSON.stringify(val)); }catch{}
    }

    function getCart(){ return loadJSON(LS.cart, { items: {} }); }
    function setCart(c){ saveJSON(LS.cart, c); syncCartBadges(); }

    function cartCount(){
      const c = getCart();
      return Object.values(c.items||{}).reduce((a,b)=>a+Number(b||0),0);
    }

    function cartTotal(){
      const c = getCart();
      let total = 0;
      for(const [id,qty] of Object.entries(c.items||{})){
        const p = catalog.find(x=>x.id===id);
        if(p) total += (Number(p.price)||0) * Number(qty||0);
      }
      return total;
    }

    function syncCartBadges(){
      const n = cartCount();
      $("#badgeCart").textContent = `${n} itens`;
      $("#s2v").textContent = n ? `Total: ${moneyBRL(cartTotal())}` : "Seu carrinho est√° vazio.";
      $("#sumCart").textContent = n ? `Itens: ${n} ‚Ä¢ Total: ${moneyBRL(cartTotal())}` : "Carrinho vazio.";
    }

    // =========================
    // NAV / SCROLL
    // =========================
    function smoothScrollTo(sel){
      const el = document.querySelector(sel);
      if(!el) return;
      el.scrollIntoView({ behavior: "smooth", block: "start" });
    }

    function setActiveTab(targetId){
      $$(".tab").forEach(t=>t.classList.toggle("active", t.getAttribute("data-scroll")===`#${targetId}`));
    }

    function wireScrollButtons(){
      document.addEventListener("click", (e)=>{
        const btn = e.target.closest("[data-scroll]");
        if(!btn) return;
        const sel = btn.getAttribute("data-scroll");
        if(!sel) return;
        e.preventDefault();
        smoothScrollTo(sel);
        const id = sel.replace("#","");
        setActiveTab(id);
      });
    }

    // =========================
    // NETWORK / HEALTH
    // =========================
    async function api(path, opt={}){
      const url = API_BASE.replace(/\/+$/,'') + path;
      const headers = { "content-type": "application/json", ...(opt.headers||{}) };
      const res = await fetch(url, { ...opt, headers });
      const txt = await res.text();
      let data = null;
      try{ data = txt ? JSON.parse(txt) : null; }catch{ data = { ok:false, error:"Resposta inv√°lida" }; }
      if(!res.ok) throw new Error(data?.error || `HTTP ${res.status}`);
      return data;
    }

    async function health(){
      try{
        const h = await api("/health", { method:"GET" });
        $("#badgeOnline").textContent = "OK";
        $("#s1v").textContent = "Sistema operacional.";
        $("#netStatus").textContent = "Worker OK";
        return h;
      }catch(err){
        $("#badgeOnline").textContent = "OFF";
        $("#badgeOnline").style.borderColor = "rgba(255,77,109,.45)";
        $("#s1v").textContent = "Sistema offline (tentando‚Ä¶)";
        $("#netStatus").textContent = "Sistema offline";
        return null;
      }
    }

    // =========================
    // CATALOG
    // =========================
    function renderCatalog(){
      const wrap = $("#catalogList");
      wrap.innerHTML = "";

      if(!catalog.length){
        $("#catalogState").textContent = "Nenhum produto dispon√≠vel.";
        return;
      }

      $("#catalogState").textContent = "";
      const c = getCart();

      for(const p of catalog){
        const qty = Number(c.items?.[p.id]||0);
        const el = document.createElement("div");
        el.className = "item";
        el.innerHTML = `
          <div class="itemLeft">
            <b>${escapeHtml(p.name || p.id)}</b>
            <span>${escapeHtml(p.description || "")}</span>
          </div>
          <div style="display:flex; align-items:center; gap:10px;">
            <div class="price">${moneyBRL(p.price || 0)}</div>
            <div class="qty" aria-label="Quantidade">
              <button type="button" data-act="dec" data-id="${escapeHtml(p.id)}" aria-label="Diminuir">‚àí</button>
              <i id="q_${escapeHtml(p.id)}">${qty}</i>
              <button type="button" data-act="inc" data-id="${escapeHtml(p.id)}" aria-label="Aumentar">+</button>
            </div>
          </div>
        `;
        wrap.appendChild(el);
      }

      wrap.addEventListener("click", (e)=>{
        const b = e.target.closest("button[data-act]");
        if(!b) return;
        const act = b.getAttribute("data-act");
        const id = b.getAttribute("data-id");
        const cart = getCart();
        cart.items = cart.items || {};
        const cur = Number(cart.items[id]||0);
        const next = act === "inc" ? cur + 1 : Math.max(0, cur - 1);
        if(next === 0) delete cart.items[id];
        else cart.items[id] = next;
        setCart(cart);
        const qEl = document.getElementById(`q_${CSS.escape(id)}`);
        if(qEl) qEl.textContent = String(next);
      }, { once:true });

      syncCartBadges();
    }

    async function loadCatalog(){
      $("#catalogState").textContent = "Carregando cat√°logo‚Ä¶";
      try{
        const r = await api("/catalog", { method:"GET" });
        catalog = Array.isArray(r.products) ? r.products : [];
        renderCatalog();
        toast("Cat√°logo carregado", `${catalog.length} produtos`);
      }catch(err){
        $("#catalogState").textContent = "Falha ao carregar cat√°logo. Tente novamente.";
        toast("Erro no cat√°logo", err.message);
      }
    }

    // =========================
    // CHECKOUT
    // =========================
    let step = 1;
    let created = { orderId:null, pix:null };

    function setStep(n){
      step = n;
      $("#stepBadge").textContent = `${n}/3`;
      $("#step1").classList.toggle("hidden", n!==1);
      $("#step2").classList.toggle("hidden", n!==2);
      $("#step3").classList.toggle("hidden", n!==3);
    }

    function validateUser(u){
      const ok = /^[A-Za-z0-9_]{3,20}$/.test(u||"");
      return ok;
    }

    function buildReview(){
      const c = getCart();
      const items = Object.entries(c.items||{});
      if(!items.length){
        $("#reviewBox").innerHTML = `<div class="help">Carrinho vazio.</div>`;
        return;
      }
      const lines = items.map(([id,qty])=>{
        const p = catalog.find(x=>x.id===id);
        const name = p?.name || id;
        const price = (Number(p?.price||0) * Number(qty||0));
        return `<div class="help"><b>${escapeHtml(name)}</b> ‚Ä¢ x${qty} ‚Ä¢ ${moneyBRL(price)}</div>`;
      }).join("");
      $("#reviewBox").innerHTML = lines + `<div class="divider"></div><div class="help"><b>Total:</b> ${moneyBRL(cartTotal())}</div>`;
    }

    async function createOrder(){
      const user = $("#rbxUser").value.trim();
      if(!validateUser(user)){
        toast("User inv√°lido", "Use letras/n√∫meros/_ (3‚Äì20)");
        return;
      }
      const c = getCart();
      const items = Object.entries(c.items||{}).map(([id,qty])=>({ id, qty:Number(qty||0) })).filter(x=>x.qty>0);
      if(!items.length){
        toast("Carrinho vazio", "Adicione produtos no cat√°logo");
        return;
      }

      $("#btnCreateOrder").disabled = true;
      $("#btnCreateOrder").style.filter = "saturate(.7)";
      toast("Gerando pedido‚Ä¶");

      try{
        const r = await api("/create-order", {
          method:"POST",
          body: JSON.stringify({ user, items })
        });
        if(!r?.ok) throw new Error(r?.error || "Falha ao criar pedido");

        created.orderId = r.orderId;
        created.pix = r.pix || r.pixCopiaCola || r.pix_payload || null;

        // Persist perfil local para "Minhas compras" (fallback)
        saveJSON(LS.profile, { user, lastOrderId: created.orderId, t: Date.now() });

        // Add to local buys index (fallback)
        const idx = loadJSON(LS.buysIndex, { user: user, orders: [] });
        if(idx.user !== user) idx.user = user;
        idx.orders = Array.isArray(idx.orders) ? idx.orders : [];
        if(!idx.orders.includes(created.orderId)) idx.orders.unshift(created.orderId);
        saveJSON(LS.buysIndex, idx);

        // UI
        $("#createdOrderId").textContent = created.orderId || "‚Äî";
        $("#pixBoxWrap").innerHTML = created.pix
          ? `<div class="help"><b>PIX copia e cola:</b></div><textarea rows="4" readonly>${escapeHtml(created.pix)}</textarea>`
          : `<div class="help">PIX n√£o dispon√≠vel no momento. Aguarde ou pe√ßa suporte no Discord.</div>`;

        toast("Pedido gerado", `Order ID: ${created.orderId}`);
        setStep(3);

        // Optional: limpar carrinho ap√≥s gerar pedido
        setCart({ items: {} });
        renderCatalog();

      }catch(err){
        toast("Erro ao gerar pedido", err.message);
      }finally{
        $("#btnCreateOrder").disabled = false;
        $("#btnCreateOrder").style.filter = "";
      }
    }

    async function checkOrder(orderId){
      const id = (orderId||"").trim();
      if(!id){ toast("Cole um Order ID"); return; }
      $("#orderResult").textContent = "Consultando‚Ä¶";
      try{
        const r = await api(`/order-status?orderId=${encodeURIComponent(id)}`, { method:"GET" });
        if(!r?.ok) throw new Error(r?.error || "Pedido n√£o encontrado");
        const s = r.status || "unknown";
        const paid = !!r.paid;
        const delivered = !!r.delivered;
        const msg = `Status: ${s}${paid?" ‚Ä¢ Pago":""}${delivered?" ‚Ä¢ Entregue":""}`;
        $("#orderResult").textContent = msg;
        toast("Pedido encontrado", msg);
      }catch(err){
        $("#orderResult").textContent = `N√£o encontrado: ${err.message}`;
        toast("Pedido n√£o encontrado", err.message);
      }
    }

    async function showMyBuys(){
      // "real" depende do Worker ter endpoint de compras por user.
      // Se n√£o existir, usamos fallback local (o que foi criado neste dispositivo).
      const prof = loadJSON(LS.profile, null);
      const user = prof?.user;
      if(!user){
        toast("Sem hist√≥rico neste dispositivo", "Crie um pedido primeiro");
        return;
      }

      // Tenta endpoint opcional: /user-orders?user=<name>
      try{
        const r = await api(`/user-orders?user=${encodeURIComponent(user)}`, { method:"GET" });
        if(r?.ok && Array.isArray(r.orders) && r.orders.length){
          const first = r.orders[0];
          $("#orderId").value = first;
          smoothScrollTo("#order");
          toast("Hist√≥rico carregado", `${r.orders.length} pedidos`);
          return;
        }
      }catch(_){ /* ignora */ }

      // fallback
      const idx = loadJSON(LS.buysIndex, { user, orders: [] });
      const first = idx?.orders?.[0];
      if(first){
        $("#orderId").value = first;
        smoothScrollTo("#order");
        toast("Hist√≥rico local", `√öltimo: ${first}`);
      } else {
        toast("Sem pedidos salvos", "Crie um pedido primeiro");
      }
    }

    // =========================
    // PWA: service worker (embedded)
    // =========================
    async function registerSW(){
      if(!('serviceWorker' in navigator)) return;
      const swCode = `
        const CACHE = 'vv-cache-v13';
        const CORE = [
          '/',
          self.location.href
        ];

        self.addEventListener('install', (e)=>{
          e.waitUntil(
            caches.open(CACHE).then(c=>c.addAll(CORE)).then(()=>self.skipWaiting())
          );
        });

        self.addEventListener('activate', (e)=>{
          e.waitUntil(
            caches.keys().then(keys=>Promise.all(keys.map(k=>k!==CACHE?caches.delete(k):null))).then(()=>self.clients.claim())
          );
        });

        self.addEventListener('fetch', (e)=>{
          const req = e.request;
          const url = new URL(req.url);

          // Network-first for API
          if(url.origin.includes('workers.dev') || url.pathname.startsWith('/create-order') || url.pathname.startsWith('/order-status')){
            e.respondWith(
              fetch(req).then(res=>{
                const copy = res.clone();
                caches.open(CACHE).then(c=>c.put(req, copy)).catch(()=>{});
                return res;
              }).catch(()=>caches.match(req))
            );
            return;
          }

          // Cache-first for everything else
          e.respondWith(
            caches.match(req).then(cached=> cached || fetch(req).then(res=>{
              const copy = res.clone();
              caches.open(CACHE).then(c=>c.put(req, copy)).catch(()=>{});
              return res;
            }))
          );
        });
      `;
      const blob = new Blob([swCode], { type: 'text/javascript' });
      const swUrl = URL.createObjectURL(blob);
      try{ await navigator.serviceWorker.register(swUrl); }catch{}
    }

    // =========================
    // i18n (minimal)
    // =========================
    const I18N = {
      pt: {
        online:"Sistema online",
        offline:"Sistema offline",
        hTitle:"Turbine seus itens do Roblox.",
        hSub:"Escolha no cat√°logo, finalize o checkout em etapas e acompanhe o pedido no app. Suporte exclusivo via Discord.",
        ctaCat:"Ver cat√°logo",
        ctaCo:"Ir pro checkout",
        ctaOrd:"Ver pedido",
        catTitle:"Cat√°logo",
        catSub:"Toque em + para adicionar ao carrinho.",
        coTitle:"Checkout",
        coSub:"Finalize em etapas ‚Äî simples e sem confus√£o.",
        ordTitle:"Pedido",
        ordSub:"Verifique se √© oficial e veja o andamento."
      },
      en: {
        online:"Online",
        offline:"Offline",
        hTitle:"Boost your Roblox items.",
        hSub:"Pick from the catalog, checkout in steps and track your order. Support via Discord.",
        ctaCat:"View catalog",
        ctaCo:"Go to checkout",
        ctaOrd:"Track order",
        catTitle:"Catalog",
        catSub:"Tap + to add to cart.",
        coTitle:"Checkout",
        coSub:"Step-by-step ‚Äî simple and clear.",
        ordTitle:"Order",
        ordSub:"Verify it‚Äôs official and track progress."
      },
      es: {
        online:"En l√≠nea",
        offline:"Sin conexi√≥n",
        hTitle:"Mejora tus √≠tems de Roblox.",
        hSub:"Elige del cat√°logo, paga por pasos y sigue tu pedido. Soporte por Discord.",
        ctaCat:"Ver cat√°logo",
        ctaCo:"Ir a pago",
        ctaOrd:"Ver pedido",
        catTitle:"Cat√°logo",
        catSub:"Toca + para agregar al carrito.",
        coTitle:"Pago",
        coSub:"Por pasos ‚Äî simple y claro.",
        ordTitle:"Pedido",
        ordSub:"Verifica si es oficial y mira el progreso."
      }
    };

    function applyLang(code){
      const t = I18N[code] || I18N.pt;
      $("#heroTitle").textContent = t.hTitle;
      $("#heroSub").textContent = t.hSub;
      $("#ctaCatalog").textContent = t.ctaCat;
      $("#ctaCheckout").textContent = t.ctaCo;
      $("#ctaOrder").textContent = t.ctaOrd;
      $("#catTitle").textContent = t.catTitle;
      $("#catSub").textContent = t.catSub;
      $("#coTitle").textContent = t.coTitle;
      $("#coSub").textContent = t.coSub;
      $("#ordTitle").textContent = t.ordTitle;
      $("#ordSub").textContent = t.ordSub;
    }

    // =========================
    // INIT
    // =========================
    function wireButtons(){
      const openDiscord = ()=>{
        try{ window.open(DISCORD_INVITE, '_blank', 'noopener,noreferrer'); }catch{ location.href = DISCORD_INVITE; }
      };
      $("#btnDiscord").addEventListener("click", openDiscord);
      $("#btnDiscord2").addEventListener("click", openDiscord);

      $("#btnReloadCatalog").addEventListener("click", loadCatalog);
      $("#btnViewCart").addEventListener("click", ()=>{
        const n = cartCount();
        toast("Carrinho", n? `Itens: ${n} ‚Ä¢ Total: ${moneyBRL(cartTotal())}` : "Vazio");
        smoothScrollTo("#checkout");
        setActiveTab("checkout");
      });

      $("#step1Btn").addEventListener("click", ()=>setStep(1));
      $("#step2Btn").addEventListener("click", ()=>{ buildReview(); setStep(2); });
      $("#step3Btn").addEventListener("click", ()=>setStep(3));

      $("#btnNext").addEventListener("click", ()=>{
        const u = $("#rbxUser").value.trim();
        if(!validateUser(u)) return toast("User inv√°lido", "Use letras/n√∫meros/_ (3‚Äì20)");
        buildReview();
        setStep(2);
      });

      $("#btnBack").addEventListener("click", ()=>setStep(1));
      $("#btnCreateOrder").addEventListener("click", createOrder);

      $("#btnCopyPix").addEventListener("click", async ()=>{
        if(!created.pix){ toast("PIX indispon√≠vel"); return; }
        try{ await navigator.clipboard.writeText(created.pix); toast("PIX copiado"); }
        catch{ toast("N√£o deu pra copiar", "Selecione e copie manualmente"); }
      });

      $("#btnGoOrder").addEventListener("click", ()=>{
        if(created.orderId) $("#orderId").value = created.orderId;
        smoothScrollTo("#order");
        setActiveTab("order");
      });

      $("#btnCheck").addEventListener("click", ()=>checkOrder($("#orderId").value));
      $("#btnMyBuys").addEventListener("click", showMyBuys);

      // Brand clickable
      $(".brand").addEventListener("click", ()=>smoothScrollTo("#home"));

      // Tabs
      $$(".tab").forEach(t=>{
        t.addEventListener("click", ()=>{
          const sel = t.getAttribute("data-scroll");
          smoothScrollTo(sel);
          setActiveTab(sel.replace("#",""));
        });
      });

      // Language
      $("#langSel").addEventListener("change", (e)=>{
        const v = e.target.value;
        saveJSON("vv_lang", v);
        applyLang(v);
        toast("Idioma", v.toUpperCase());
      });

      // Install
      $("#btnInstall").addEventListener("click", async ()=>{
        if(deferredPrompt){
          deferredPrompt.prompt();
          const r = await deferredPrompt.userChoice;
          deferredPrompt = null;
          toast("Instala√ß√£o", r.outcome === 'accepted' ? "Aceita" : "Cancelada");
        } else {
          toast("Instalar", "Use: Menu do navegador ‚Üí Adicionar √† tela inicial");
        }
      });
    }

    function wirePWA(){
      window.addEventListener('beforeinstallprompt', (e)=>{
        e.preventDefault();
        deferredPrompt = e;
        toast("Instala√ß√£o dispon√≠vel", "Toque em Instalar");
      });
    }

    function wireOnlineOffline(){
      const upd = ()=>{
        const ok = navigator.onLine;
        $("#netStatus").textContent = ok ? "Sistema online" : "Sistema offline";
      };
      window.addEventListener('online', ()=>{ upd(); toast("Online"); health(); loadCatalog(); });
      window.addEventListener('offline', ()=>{ upd(); toast("Offline", "Modo limitado"); });
      upd();
    }

    (async function init(){
      document.documentElement.style.scrollBehavior = "smooth";
      wireScrollButtons();
      wireButtons();
      wirePWA();
      wireOnlineOffline();
      await registerSW();

      const lang = loadJSON("vv_lang", "pt");
      $("#langSel").value = lang;
      applyLang(lang);

      syncCartBadges();
      await health();
      await loadCatalog();

      // Prepare checkout state
      setStep(1);
      buildReview();
    })();
  </script>
</body>
</html>
